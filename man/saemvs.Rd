% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/methods-saemvs.r
\name{saemvs}
\alias{saemvs}
\alias{saemvs,saemvsData,saemvsModel,saemvsInit,saemvsTuning,saemvsHyperSlab-method}
\title{Sparse Variable Selection with SAEM}
\usage{
saemvs(
  data,
  model,
  init,
  tuning_algo,
  hyperparam,
  pen = "e-BIC",
  use_cpp = TRUE
)

\S4method{saemvs}{saemvsData,saemvsModel,saemvsInit,saemvsTuning,saemvsHyperSlab}(
  data,
  model,
  init,
  tuning_algo,
  hyperparam,
  pen = "e-BIC",
  use_cpp = TRUE
)
}
\arguments{
\item{data}{An object of class \code{saemvsData}
containing the dataset (observations and design matrices).}

\item{model}{An object of class \code{saemvsModel}
specifying the model structure and the parameters
that are candidates for selection (\code{phi_to_select}).}

\item{init}{An object of class \code{saemvsInit}
providing the initialization for the SAEM algorithm.}

\item{tuning_algo}{An object of class
\code{saemvsTuning} containing algorithmic tuning
parameters such as the spike grid (\code{spike_values_grid}), number of workers,
and random seed.}

\item{hyperparam}{An object of class
\code{saemvsHyperSlab} containing the
hyperparameters for the slab prior.}

\item{pen}{Character string indicating the model selection criterion. Must be
either \code{"BIC"} or \code{"e-BIC"}.}

\item{use_cpp}{Logical. If \code{TRUE} (default), the C++ backend of the model
function is compiled and used. If \code{FALSE}, a non-C++ (R-based) backend
may be used. The model function is compiled on each worker when running
in parallel.}
}
\value{
An object of class \code{saemvsResults} containing:
\itemize{
\item \code{criterion}: The selection criterion used (\code{"BIC"} or \code{"e-BIC"}).
\item \code{criterion_values}: Values of the selected information criterion
(BIC or e-BIC), computed from the log-likelihood of the MLE associated
with each unique support.
\item \code{thresholds}: Thresholds computed for each spike value.
\item \code{beta_map}: MAP estimates of regression parameters for each spike
value.
\item \code{mle_estimates}: MLE estimates for each unique support.
\item \code{support}: List of supports obtained across spike values.
\item \code{unique_support}: List of unique supports identified.
\item \code{support_mapping}: Mapping from each run to the corresponding unique
support.
\item \code{spike_values_grid}: The grid of spike variances used.
\item \code{phi_fixed_idx}: Indices of fixed parameters.
\item \code{phi_to_select_idx}: Indices of parameters subject to selection.
\item \code{forced_variables_idx}: For each unique support, indices of
covariates that were forced into the model (always included).
\item \code{selected_variables_idx}: For each unique support, indices of
covariates that were actively selected by the algorithm (excluding forced
ones).
}
}
\description{
The \code{saemvs} function performs stochastic approximation EM (SAEM)
combined with variable selection using a spike-and-slab prior.
It supports both BIC and extended BIC (e-BIC) as model selection criteria.
}
\details{
This method explores a grid of spike variances (\code{nu0}) in parallel,
fits MAP estimates for each spike value, derives candidate supports,
and then evaluates unique supports with the chosen information
criterion to select the best model.

The procedure is carried out in two steps:
\enumerate{
\item For each spike variance candidate (\code{nu0}), a MAP estimation is
performed in parallel, producing supports, thresholds, and MAP estimates.
\item Unique supports are identified, and each support is re-evaluated
with the chosen information criterion (\code{pen}) to select the most
appropriate model.
}
A support corresponds to a specific subset of parameters (among
\code{phi_to_selectx}) that are included in the model, typically represented
as a binary inclusion pattern obtained after thresholding the MAP estimates.
For a given support, covariates are partitioned into:
\itemize{
\item \emph{forced variables}, which are always included in the model
(e.g., fixed effects or parameters not subject to spike-and-slab
selection),
\item \emph{selected variables}, which are actively selected by the
spike-and-slab procedure among the candidate parameters.
}

Parallel execution is handled using the \code{future} and \code{furrr} packages.
}
\examples{
\dontrun{
# Assuming data_obj, model_obj, init_obj, tuning_obj, hyper_obj are created
result <- saemvs(
  data = data_obj,
  model = model_obj,
  init = init_obj,
  tuning_algo = tuning_obj,
  hyperparam = hyper_obj,
  pen = "e-BIC"
)
}

}
