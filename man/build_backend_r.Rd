% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/model-utils.r
\name{build_backend_r}
\alias{build_backend_r}
\title{Build R Backend for Model Functions}
\usage{
build_backend_r(g_fun)
}
\arguments{
\item{g_fun}{A function that takes parameters \code{phi} and time \code{t} and returns
a scalar numeric value representing the model prediction.}
}
\value{
A list containing the following functions:
\item{g_scalar}{Wrapper around \code{g_fun} that evaluates the model for a
single time point.}
\item{g_vector}{Vectorized version of the model function that evaluates
\code{g_fun} across multiple time points using \code{vapply}.}
\item{rmvnorm}{Generates random samples from a multivariate normal
distribution using \code{MASS::mvrnorm}. Requires the MASS package.}
\item{rmvnorm_mat(mean, sigma, n)}{Generates \code{n} draws from a
multivariate normal distribution.}
\item{logdmvnorm}{Computes the log-density of a multivariate normal
distribution given a mean vector and covariance matrix.}
\item{metropolis_vector}{Implements a Metropolis-Hastings algorithm for
sampling from the posterior distribution of parameters. Supports
population and random walk proposal kernels. Returns a list of sampled
parameter chains.}
\item{ll(yi_list, ti_list, phi_samples, sigma2)}{Computes the
log-likelihood for a list of observed responses \code{yi_list} over times
\code{ti_list}, given sampled parameters \code{phi_samples} and variance \code{sigma2}.}
}
\description{
Creates a list of backend functions for model evaluation and
Metropolis-Hastings sampling in R, providing scalar and vectorized
versions of a model function along with multivariate normal sampling
and density evaluation utilities.
}
\details{
The \code{metropolis_vector} function performs adaptive Metropolis-Hastings
sampling for multiple individuals in parallel, accepting or rejecting
proposed parameter values based on the log-likelihood ratio and proposal
density ratio (for random walk kernel).
}
\examples{
\dontrun{
g_model <- function(phi, t) phi[1] * exp(-phi[2] * t)
backend <- build_backend_r(g_model)
samples <- backend$g_vector(c(1, 0.5), c(0, 1, 2, 3))
}

}
\keyword{internal}
