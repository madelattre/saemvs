% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/model-utils.r
\name{build_backend_cpp}
\alias{build_backend_cpp}
\title{Build C++ Backend for Model functions}
\usage{
build_backend_cpp(g_fun, debug = FALSE)
}
\arguments{
\item{g_fun}{A function that defines the structural model.
This function should take parameters (phi) and time (t) as inputs.}

\item{debug}{Logical. If TRUE, returns the generated C++ code as a string
without compilation. Useful for inspecting generated code. Default is
FALSE.}
}
\value{
A list containing five compiled C++ functions:
\describe{
\item{g_scalar}{Evaluates the structural model at a single time point.
Takes phi (parameters vector) and t (time point).}
\item{g_vector}{Vectorized version of g_scalar for multiple time points.
Takes phi (parameters vector) and t (times vector).}
\item{rmvnorm}{Generates random samples from a multivariate normal
distribution. Takes mean (vector) and sigma (covariance matrix).}
\item{rmvnorm_mat(mean, sigma, n)}{Generates \code{n} draws from a
multivariate normal distribution. Returns an \verb{n x d} matrix.}
\item{logdmvnorm}{Computes log-probability density of multivariate
normal.
Takes x (observation vector), mean (vector), and sigma (covariance
matrix).}
\item{metropolis_vector}{Implements Metropolis-Hastings MCMC sampler
for population parameters. Takes y (observations), t (times),
phi_current (current parameters), mean_prop (proposal mean),
var_prop_mat (proposal covariance), sigma2 (residual variance),
niter_mh (number of iterations), kappa (scaling factor), and
kernel (proposal type: "pop" or "random_walk").}
\item{ll(yi_list, ti_list, phi_samples, sigma2)}{Computes the
log-likelihood of observed data given parameter samples.}
}
}
\description{
Generates and compiles a C++ backend for efficient computation of a
model provided by the user. This function transpiles an R
function to C++ and creates compiled functions for model evaluation,
sampling, and likelihood computation.
}
\details{
When debug = FALSE, this function:
\enumerate{
\item Transpiles the input R function to C++
\item Embeds it in a C++ template with supporting functions
\item Writes the code to a temporary file
\item Compiles using Rcpp::sourceCpp
\item Returns compiled functions in the global environment
}
}
\examples{
\dontrun{
# Define a simple PK model
pk_model <- function(phi, t) {
  phi[1] * exp(-phi[2] * t)
}

# Build the C++ backend
backend <- build_backend_cpp(pk_model)

# Use compiled functions for inference
samples <- backend$metropolis_vector(
  y, t, phi_init, mean_prop, var_prop, sigma2, niter
)
}

}
\keyword{internal}
