% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc-utils.r
\name{estimate_phi_individuals}
\alias{estimate_phi_individuals}
\title{Estimate individual-level phi parameters}
\usage{
estimate_phi_individuals(data, model, init, maxit = 1000)
}
\arguments{
\item{data}{An object of class \code{saemvsData} containing the observed
data. It is expected to provide the time series via the slots
\code{y_series} (list of response vectors) and \code{t_series} (list of
corresponding time vectors).}

\item{model}{An object of class \code{saemvsModel} representing the model
structure. It should provide at least the following slots:
\describe{
\item{\code{model_func}}{A function \eqn{g(\varphi, t)} that returns the
model prediction given parameters and time.}
\item{\code{phi_dim}}{An integer specifying the dimension of the
parameter vector \eqn{\varphi}.}
}}

\item{init}{An object of class \code{saemvsInit} providing initial values
for optimization. It is expected to include an \code{intercept} slot
used to initialize and bound the search.}

\item{maxit}{Integer. Maximum number of iterations allowed for the optimizer.
Defaults to 1000.}
}
\value{
A numeric matrix of dimension \eqn{n \times q}, where
\eqn{n} is the number of individuals and \eqn{q} is the number of
estimated \eqn{\varphi} parameters. Column names are of the form
\code{"phi1"}, \code{"phi2"}, etc.
}
\description{
This internal function estimates the individual-specific \eqn{\varphi}
parameters for each series in the provided dataset, given a model structure
and initial parameter values. Optimization is performed independently for
each individual using the L-BFGS-B method.
}
\details{
For each individual \eqn{i}, the function minimizes the sum of squared
errors:
\deqn{SSE(\varphi_i) = \sum_t (y_{i,t} - g(t, \varphi_i))^2}
using the \code{optim()} function with box constraints. Lower bounds are set
to zero, and upper bounds are ten times the initial intercept value.

The optimization results are stored in a matrix with one row per individual
and one column per parameter.
}
\examples{
\dontrun{
est <- estimate_phi_individuals(
  data = my_data, model = my_model,
  init = my_init
)
}

}
\keyword{internal}
