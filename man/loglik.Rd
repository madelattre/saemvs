% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/methods-loglik.r
\name{loglik}
\alias{loglik}
\title{Compute log-likelihood (or penalized log-likelihood) for a SAEMVS model}
\usage{
loglik(
  data,
  model,
  tuning_algo,
  param,
  pen,
  p,
  phi_to_select_idx,
  nb_forced_beta,
  backend
)
}
\arguments{
\item{data}{A \code{saemvsData} object containing the response variables
and design matrices.}

\item{model}{A \code{saemvsProcessedModel} object defining the model
structure,
including covariates, random effects, and indices of parameters to select.}

\item{tuning_algo}{A \code{saemvsTuning} object specifying algorithmic
tuning parameters such as number of Monte Carlo samples.}

\item{param}{A list of parameter estimates with components:
\describe{
\item{beta}{Matrix of fixed-effect coefficients.}
\item{gamma}{Covariance matrix of random effects.}
\item{sigma2}{Residual variance.}
}}

\item{pen}{Character string specifying the penalty type. One of
\code{"BIC"}, \code{"e-BIC"}, or \code{""} for no penalty.}

\item{p}{Numeric. Total number of candidate covariates (used for e-BIC).}

\item{phi_to_select_idx}{Integer vector of indices of covariates subject
to selection (used to adjust the penalization term).}

\item{nb_forced_beta}{Integer. Number of covariates forced to be included
in the model (affects penalization in e-BIC).}

\item{backend}{A list of compiled functions (e.g., \code{g_vector}) for
evaluating model predictions efficiently.}
}
\value{
Numeric. The penalized log-likelihood (BIC or e-BIC) value.
}
\description{
Internal function to compute the (penalized) log-likelihood of the data
given the model and parameter estimates. Supports different penalties
such as "BIC" and "e-BIC".
}
\details{
The function proceeds as follows:
\enumerate{
\item Preprocess the data using \code{prepare_data()}.
\item For each subject/series, generate Monte Carlo samples of the latent
parameters (\code{phi}) from a multivariate normal distribution
with mean \eqn{\beta \times X} and covariance \eqn{\gamma}.
\item Compute the likelihood contribution for each series using
the model function in \code{backend}.
\item Sum over all series to obtain the total log-likelihood.
\item Apply the specified penalty ("BIC" or "e-BIC") using the number of
selected covariates and forced covariates.
}
}
\keyword{internal}
