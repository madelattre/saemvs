% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/methods-plots.r
\name{convergence_plot}
\alias{convergence_plot}
\alias{convergence_plot,saemResults,character-method}
\title{Plot Convergence Diagnostics for SAEM Estimation}
\usage{
convergence_plot(res_saem, component, sel_components, ...)

\S4method{convergence_plot}{saemResults,character}(res_saem, component, sel_components, phi = NULL)
}
\arguments{
\item{res_saem}{An object of class \code{saemResults}, containing results from a
SAEM estimation procedure. It must include slots such as \verb{@sigma2},
\verb{@beta_to_select}, \verb{@beta_not_to_select}, \verb{@gamma_to_select},
\verb{@gamma_not_to_select}, and corresponding index vectors.}

\item{component}{A character string specifying which element to plot.
Must be one of:
\itemize{
\item \code{"sigma2"}: residual variance
\item \code{"coef_phi_sel"}: regression coefficients for parameters subject to
selection
\item \code{"coef_phi_non_sel"}: regression coefficients for parameters not
subject to selection
\item \code{"variance_phi_sel"}: covariance matrix of parameters subject to
selection
\item \code{"variance_phi_non_sel"}: covariance matrix of parameters not
subject to selection
}}

\item{sel_components}{Optional specification of components to display.
Can be a character vector of facet labels, \code{"random"}, or \code{"top:n"}.
Defaults to the first 16 components.}

\item{...}{Further arguments passed to or from other methods (not used).

#' @details
The function automatically adjusts the x-axis tick marks to ensure
readability and limits the number of displayed components to a maximum of 16
subplots.
Users can specify which components to display using the \code{sel_components}
argument:
\itemize{
\item If omitted, the first 16 components are plotted.
\item \code{"random"} randomly selects up to 16 components.
\item \code{"top:n"} selects the \emph{n} components with the highest variance across
iterations.
}
For \code{coef_phi_sel} and \code{variance_phi_sel}, the argument \code{phi} must refer to a
parameter that is subject to selection (i.e., within \code{phi_to_select_idx}).
Conversely, for \code{coef_phi_non_sel} and \code{variance_phi_non_sel}, \code{phi} must
correspond to a non-selected parameter (within \code{phi_not_to_select_idx}).
Incompatible combinations will trigger an error.}

\item{phi}{Optional integer specifying a parameter index to focus on.
Used mainly with \code{component} values referring to parameters subject or not
subject to selection.}
}
\value{
A \href{https://ggplot2.tidyverse.org/}{\code{ggplot2}} object showing the evolution
of the specified component across SAEM iterations. The plot is also printed
to the active graphical device. Returns \code{invisible(NULL)} if no data is
available for the requested component.
}
\description{
Produces diagnostic plots showing the convergence of parameter estimates
obtained with the Stochastic Approximation Expectation Maximization (SAEM)
algorithm. Depending on the selected \code{component}, this function displays the
evolution of the residual variance (\code{sigma2}), regression coefficients
(\code{coef_phi_sel} or \code{coef_phi_non_sel}), or covariance matrices
(\code{variance_phi_sel} or \code{variance_phi_non_sel}) across iterations.
}
\examples{
\dontrun{
# Example usage (assuming `res` is an object of class 'saemResults'):
convergence_plot(res, component = "sigma2")
convergence_plot(res, component = "coef_phi_sel", sel_components = "top:8")
}

}
