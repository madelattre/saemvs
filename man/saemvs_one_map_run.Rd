% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/methods-saemvs.r
\name{saemvs_one_map_run}
\alias{saemvs_one_map_run}
\title{Internal: Single MAP Run of SAEMVS}
\usage{
saemvs_one_map_run(data, model, init, tuning_algo, hyperparam, backend)
}
\arguments{
\item{data}{An object of class
\link[=saemvsProcessedData-class]{saemvsProcessedData}
containing the processed dataset (observations and design matrices),
as returned by internal preprocessing steps.}

\item{model}{An object of class
\link[=saemvsProcessedModel-class]{saemvsProcessedModel}
specifying the processed model structure and indices of parameters subject}

\item{init}{An object of class
\link[=saemvsProcessedInit-class]{saemvsProcessedInit}
providing processed initial values for the SAEM algorithm.}

\item{tuning_algo}{An object of class
\link[=saemvsTuning-class]{saemvsTuning}
defining algorithmic parameters such as the number of iterations
(\code{niter}).}

\item{hyperparam}{An object of class
\link[=saemvsHyperSpikeAndSlab-class]{saemvsHyperSpikeAndSlab}
containing hyperparameters of the spike-and-slab prior (spike variance,
slab variance, and mixing proportion).}

\item{backend}{A list containing the compiled model backend (typically
generated by \code{\link{compile_model}}), used by \code{\link{run_saem}}
to evaluate the model likelihood and its derivatives.}
}
\value{
A \code{list} with elements:
\itemize{
\item \code{threshold} Vector of threshold values applied to coefficients.
\item \code{support} Logical matrix indicating which variables are
selected in the final MAP solution. Rows correspond to variables
subject to selection (with the intercept as the first row), and
columns correspond to model parameters. Variables that are forced
into the model are always marked as \code{TRUE}.
\item \code{beta} Matrix of MAP coefficient estimates.
}
}
\description{
Performs one MAP estimation run of the SAEM algorithm for a given
spike-and-slab prior configuration.
This function is used internally by \code{\link{saemvs}} to explore
different spike variances and extract candidate supports.
}
\details{
The function runs the SAEM algorithm via \code{\link{run_saem}}, then
constructs the MAP estimates of coefficients and derives the support set by
thresholding \eqn{\beta} coefficients.
Threshold values are computed from the spike-and-slab hyperparameters
(spike variance, slab variance, and mixing proportions) and are applied
uniformly across parameters to determine inclusion based on the magnitude
of the MAP estimates.
Forced covariates (specified in \code{x_forced_support}) are inserted
at the top of the support matrix (after the intercept) and are always
marked as selected, regardless of the thresholding step.

The returned support matrix includes the intercept term as the first row.
}
\seealso{
\code{\link{saemvs}}, \code{\link{run_saem}}
}
\keyword{internal}
