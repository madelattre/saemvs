% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/methods-saemvs.r
\name{saemvs_one_map_run}
\alias{saemvs_one_map_run}
\title{Internal: Single MAP Run of SAEMVS}
\usage{
saemvs_one_map_run(data, model, init, tuning_algo, hyperparam)
}
\arguments{
\item{data}{An object of class \link[=saemvsData-class]{saemvsData}
containing the dataset (observations and design matrices).}

\item{model}{An object of class \link[=saemvsModel-class]{saemvsModel}
specifying the model structure and indices of parameters subject
to selection (\code{phi_to_select_idx}).}

\item{init}{An object of class \link[=saemvsInit-class]{saemvsInit}
providing initial values for the SAEM algorithm.}

\item{tuning_algo}{An object of class \link[=saemvsTuning-class]{saemvsTuning}
defining algorithmic parameters such as the number of iterations (\code{niter}).}

\item{hyperparam}{An object of class \link[=saemvsHyperSpikeAndSlab-class]{saemvsHyperSpikeAndSlab}
containing hyperparameters of the spike-and-slab prior
(spike variance, slab variance, and mixing proportion).}
}
\value{
A \code{list} with elements:
\itemize{
\item \code{threshold} Vector of threshold values applied to coefficients.
\item \code{support} Logical matrix indicating selected variables
across iterations (including intercept).
\item \code{beta} Matrix of MAP coefficient estimates.
}
}
\description{
Performs one MAP estimation run of the SAEM algorithm for a given
spike-and-slab prior configuration.
This function is used internally by \code{\link{saemvs}} to explore
different spike variances and extract candidate supports.
}
\details{
The function runs the SAEM algorithm via \code{\link{run_saem}},
then constructs the MAP estimates of coefficients and derives
the support set by thresholding \eqn{\beta} coefficients.

Special handling is performed for parameters that are forced
to be in the model (\code{x_forced_support}).
These are always marked as selected in the support matrix.

The returned support matrix includes the intercept term as the first row.
}
\seealso{
\code{\link{saemvs}}, \code{\link{run_saem}}
}
\keyword{internal}
