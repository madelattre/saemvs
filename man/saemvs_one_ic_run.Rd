% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/methods-saemvs.r
\name{saemvs_one_ic_run}
\alias{saemvs_one_ic_run}
\title{Internal: EBIC/BIC Evaluation for a Candidate Support}
\usage{
saemvs_one_ic_run(k, support, data, model, init, tuning_algo, pen, backend)
}
\arguments{
\item{k}{Integer index indicating which element of the \code{support} list
is evaluated (i.e., \code{support[[k]]}).}

\item{support}{A list of logical or numeric matrices, each representing
a candidate support. Rows correspond to covariates subject to selection
(with the intercept as the first row), and columns correspond to model
parameters. Forced covariates may be included as leading rows and are
handled separately.}

\item{data}{An object of class
\link[=saemvsProcessedData-class]{saemvsProcessedData},
containing the processed dataset restricted to candidate variables.}

\item{model}{An object of class
\link[=saemvsProcessedModel-class]{saemvsProcessedModel},
specifying model structure and indices of parameters subject to selection.}

\item{init}{An object of class
\link[=saemvsProcessedInit-class]{saemvsProcessedInit},
providing processed initialization values for SAEM under the restricted
model.}

\item{tuning_algo}{An object of class
\link[=saemvsTuning-class]{saemvsTuning}, containing algorithmic tuning
parameters (e.g. number of iterations).}

\item{pen}{Character string, the information criterion to use. Must be either
\code{"BIC"} or \code{"e-BIC"}.}

\item{backend}{A list containing the compiled model backend (typically
produced by \code{\link{compile_model}}), used for likelihood evaluation
and SAEM-based MLE estimation.}
}
\value{
A \code{list} with elements:
\itemize{
\item \code{ll} Numeric, the penalized log-likelihood value (BIC/e-BIC).
\item \code{mle_param} List of estimated parameters under the restricted
model:
\itemize{
\item \code{beta} Estimated regression coefficients.
\item \code{gamma} Estimated variances for the random effects.
\item \code{sigma2} Estimated residual variance.
\item \code{forced_variables_idx} Integer vector giving the row indices
(within the support matrix) of covariates that were forced into the model.
\item \code{selected_variables_idx} Integer vector giving the row indices
of covariates that were actively selected among the candidate covariates
(excluding forced ones).
}
}
}
\description{
Performs a maximum likelihood estimation (MLE) of the model restricted to
a given support set of parameters, and computes the corresponding
information criterion (BIC or extended BIC).
}
\details{
This function is used internally by \code{\link{saemvs}} in the second step
of the SAEMVS algorithm to rank candidate supports obtained from MAP runs.

The function restricts the model to the variables specified in
\code{support[[k]]}, taking into account variables that are always forced
into the model (\code{x_forced_support}).
The SAEM algorithm is then rerun under this restricted model to obtain
MLE estimates of the parameters.
Finally, the log-likelihood penalized by the chosen criterion (BIC/e-BIC)
is computed via \code{\link{loglik}}.
}
\seealso{
\code{\link{saemvs}}, \code{\link{saemvs_one_map_run}},
\code{\link{loglik}}
}
\keyword{internal}
