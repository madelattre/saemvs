% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc-utils.r
\name{build_init_from_phi_lasso}
\alias{build_init_from_phi_lasso}
\title{Build initial values from individual phi estimates using Lasso}
\usage{
build_init_from_phi_lasso(
  est_indiv,
  data_processed,
  model,
  init,
  lasso_lambda = NULL
)
}
\arguments{
\item{est_indiv}{A numeric matrix of dimension \eqn{n \times q}, where
\eqn{n} is the number of individuals and \eqn{q} the number of
\eqn{\varphi} parameters. Typically obtained from
\code{estimate_phi_individuals}.}

\item{data_processed}{An object of class \code{saemvsDataProcessed} (or
similar) containing pre-processed covariates for \eqn{\varphi} parameters
subject and not suject to selection. Expected to provide at least the slots
\code{x_phi_to_select} and \code{x_phi_not_to_select}.}

\item{model}{An object of class \code{saemvsModel} representing the model
structure, with slots:
\describe{
\item{\code{phi_to_select_idx}}{Indices of \eqn{\varphi} parameters on
which to apply the Lasso selection.}
\item{\code{x_forced_support}}{Support (binary) matrix indicating the
position of forced covariates.}
}}

\item{init}{An object of class \code{saemvsInit} providing initial values
for the intercept, covariance matrix, and residual variance.}

\item{lasso_lambda}{Optional numeric value specifying the lambda to use for
Lasso regression. If \code{NULL}, the minimum lambda from the Lasso path
is used.}
}
\value{
An object of class \code{saemvsInit} containing initial values
for the SAEM-VS algorithm.
}
\description{
This internal function constructs an initial \code{saemvsInit} object for
the SAEMVS algorithm based on individual-level \eqn{\phi} estimates. Lasso
regression is applied to initialize coefficients corresponding to the
parameters that are subject to selection, while ordinary least squares is
used for the parameters that are not subject to selection.
}
\details{
For parameters designated for selection, Lasso regression is applied to
the corresponding covariates. For non-selected parameters, ordinary least
squares regression is used. Forced covariates indicated by the model are
incorporated into the \code{beta_forced} matrix, and the remaining
coefficients are stored in \code{beta_candidates}.

The resulting \code{saemvsInit} object contains:
\itemize{
\item \code{intercept}: initial intercept values.
\item \code{beta_candidates}: candidate coefficients for selection.
\item \code{beta_forced}: coefficients for forced covariates.
\item \code{cov_re}: covariance matrix of random effects.
\item \code{sigma2}: residual variance.
}
}
\examples{
\dontrun{
init_obj <- build_init_from_phi_lasso(
  est_indiv = phi_est_matrix,
  data_processed = processed_data,
  model = my_model,
  init = init_values
)
}
}
\keyword{internal}
