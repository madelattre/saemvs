% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/m-steps.r
\name{m_step_to_select}
\alias{m_step_to_select}
\title{Internal M-step: update parameters subject to selection}
\usage{
m_step_to_select(config, k, state, backend)
}
\arguments{
\item{config}{List containing model configuration, including:
\itemize{
\item \code{x_phi_to_select}: design matrix for parameters subject to
selection,
\item \code{tx_x_phi_to_select}, \code{kron_tx_x_phi_to_select}:
precomputed matrices for M-step,
\item \code{num_series}: number of independent series,
\item \code{num_covariates_to_select}: number of covariates for
to-select parameters,
\item \code{num_parameters_to_select}: number of parameters subject to
selection,
\item \code{phi_intercept_prior_variance}: prior variance for intercept
terms,
\item \code{spike_parameter}, \code{slab_parameter}: spike-and-slab
prior hyperparameters,
\item \code{inclusion_prob_prior_a}, \code{inclusion_prob_prior_b}:
hyperparameters for inclusion probabilities,
\item \code{cov_re_prior_scale}, \code{cov_re_prior_df}: prior parameters
for gamma,
\item \code{covariance_decay}: scaling factor used for shrinkage of
gamma matrices.
}}

\item{k}{Integer, current iteration index (1-based), used to index and update
\code{state$beta_to_select}, \code{state$gamma_to_select}, and
\code{state$alpha}.}

\item{state}{List containing the current MCMC state, including:
\itemize{
\item \code{phi}: list of latent parameter matrices per iteration,
\item \code{s2_to_select}, \code{s3_to_select}: stochastic approximation
statistics for to-select parameters,
\item \code{beta_to_select}: list of regression coefficient matrices
for parameters to select,
\item \code{gamma_to_select}: list of covariance matrices for parameters
to select,
\item \code{alpha}: vector of inclusion probabilities per iteration.
}
These components are read and updated in the M-step for parameters subject
to selection.}

\item{backend}{A list of compiled model functions and helper routines,
passed for interface consistency with the SAEM iteration framework.}
}
\value{
Updated \code{state} list with:
\itemize{
\item \code{beta_to_select[[k + 1]]}: updated regression coefficients,
\item \code{gamma_to_select[[k + 1]]}: updated covariance matrix
(symmetric, possibly shrinked),
\item \code{alpha[[k + 1]]}: updated inclusion probabilities,
\item other components of \code{state} remain unchanged.
}
}
\description{
Performs the M-step updates for parameters that are subject to variable
selection. Updates regression coefficients (\code{beta_to_select}), covariance
matrices (\code{gamma_to_select}), and inclusion probabilities (\code{alpha}) for the
"to_select" parameters.
}
\note{
This function performs the M-step for parameters subject to variable
selection,
enforcing symmetry of covariance matrices and applying shrinkage if
necessary.
Inclusion probabilities are updated according to a Beta prior and
spike-and-slab posterior.
It is intended for internal use within the SAEM-MCMC algorithm.
}
\keyword{internal}
